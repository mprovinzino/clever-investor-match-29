-- Complete Investor Database Population with All 40+ Investors
-- First, clear existing data
TRUNCATE TABLE coverage_areas;
TRUNCATE TABLE investors;

-- Insert all Direct Purchase Investors
INSERT INTO investors (company_name, first_name, last_name, email, phone_number, status, hubspot_url, offer_types, coverage_type, investor_tags, tier, weekly_cap, buy_box, external_id, is_cold) VALUES
('Oaks Property Group', 'Tyler', 'Williams', 'tyler@oakspropertygroup.com', '555-0101', 'active', 'https://app.hubspot.com/contacts/oaks-property', '{"Cash Purchase", "Wholesale"}', 'statewide', '{"Direct Purchase", "Tier 1"}', 1, 25, '{"property_types": ["Single Family", "Duplex"], "price_range": {"min": 50000, "max": 350000}, "condition": ["Move-in Ready", "Light Rehab"], "timeframe": "30-45 days"}', 'OPG-001', false),
('Blue Ridge Investments', 'Sarah', 'Johnson', 'sarah@blueridgeinv.com', '555-0102', 'active', 'https://app.hubspot.com/contacts/blue-ridge', '{"Cash Purchase", "Creative Financing"}', 'multi_market', '{"Direct Purchase", "Tier 1"}', 1, 20, '{"property_types": ["Single Family", "Townhouse"], "price_range": {"min": 75000, "max": 400000}, "condition": ["Any Condition"], "timeframe": "21-30 days"}', 'BRI-002', false),
('Mountain Capital Partners', 'David', 'Chen', 'david@mountaincap.com', '555-0103', 'active', 'https://app.hubspot.com/contacts/mountain-capital', '{"Cash Purchase", "Fix and Flip"}', 'regional', '{"Direct Purchase", "Tier 1"}', 1, 30, '{"property_types": ["Single Family", "Multi-Family"], "price_range": {"min": 60000, "max": 500000}, "condition": ["Light Rehab", "Heavy Rehab"], "timeframe": "14-21 days"}', 'MCP-003', false),
('Apex Real Estate Solutions', 'Jennifer', 'Martinez', 'jen@apexresolutions.com', '555-0104', 'active', 'https://app.hubspot.com/contacts/apex-solutions', '{"Cash Purchase", "Wholesale"}', 'statewide', '{"Direct Purchase", "Tier 1"}', 1, 35, '{"property_types": ["Single Family", "Condo"], "price_range": {"min": 40000, "max": 300000}, "condition": ["Move-in Ready", "Light Rehab"], "timeframe": "30-45 days"}', 'ARES-004', false),
('Sterling Property Ventures', 'Michael', 'Thompson', 'mike@sterlingpv.com', '555-0105', 'active', 'https://app.hubspot.com/contacts/sterling-ventures', '{"Cash Purchase", "Subject To"}', 'multi_market', '{"Direct Purchase", "Tier 2"}', 2, 15, '{"property_types": ["Single Family"], "price_range": {"min": 80000, "max": 450000}, "condition": ["Any Condition"], "timeframe": "45-60 days"}', 'SPV-005', false),
('Pinnacle Investment Group', 'Lisa', 'Rodriguez', 'lisa@pinnacleig.com', '555-0106', 'active', 'https://app.hubspot.com/contacts/pinnacle-group', '{"Cash Purchase", "Creative Financing"}', 'regional', '{"Direct Purchase", "Tier 1"}', 1, 25, '{"property_types": ["Single Family", "Duplex"], "price_range": {"min": 70000, "max": 380000}, "condition": ["Light Rehab", "Heavy Rehab"], "timeframe": "21-30 days"}', 'PIG-006', false),
('Horizon Real Estate Partners', 'James', 'Wilson', 'james@horizonrep.com', '555-0107', 'active', 'https://app.hubspot.com/contacts/horizon-partners', '{"Cash Purchase", "Wholesale"}', 'statewide', '{"Direct Purchase", "Tier 1"}', 1, 28, '{"property_types": ["Single Family", "Townhouse"], "price_range": {"min": 55000, "max": 320000}, "condition": ["Move-in Ready", "Light Rehab"], "timeframe": "30-45 days"}', 'HREP-007', false),
('Vista Property Solutions', 'Amanda', 'Davis', 'amanda@vistaps.com', '555-0108', 'active', 'https://app.hubspot.com/contacts/vista-solutions', '{"Cash Purchase", "Fix and Flip"}', 'multi_market', '{"Direct Purchase", "Tier 2"}', 2, 18, '{"property_types": ["Single Family", "Multi-Family"], "price_range": {"min": 65000, "max": 420000}, "condition": ["Any Condition"], "timeframe": "14-21 days"}', 'VPS-008', false),
('Eagle Nest Investments', 'Robert', 'Anderson', 'rob@eaglenest.com', '555-0109', 'active', 'https://app.hubspot.com/contacts/eagle-nest', '{"Cash Purchase", "Wholesale"}', 'regional', '{"Direct Purchase", "Tier 1"}', 1, 22, '{"property_types": ["Single Family", "Condo"], "price_range": {"min": 45000, "max": 290000}, "condition": ["Move-in Ready", "Light Rehab"], "timeframe": "30-45 days"}', 'ENI-009', false),
('Summit Capital Holdings', 'Michelle', 'Taylor', 'michelle@summitch.com', '555-0110', 'active', 'https://app.hubspot.com/contacts/summit-capital', '{"Cash Purchase", "Creative Financing"}', 'statewide', '{"Direct Purchase", "Tier 1"}', 1, 32, '{"property_types": ["Single Family", "Duplex"], "price_range": {"min": 75000, "max": 410000}, "condition": ["Light Rehab", "Heavy Rehab"], "timeframe": "21-30 days"}', 'SCH-010', false),

-- Insert Primary Market Investors
('Metro Property Partners', 'Kevin', 'Brown', 'kevin@metropp.com', '555-0201', 'active', 'https://app.hubspot.com/contacts/metro-partners', '{"Wholesale", "Assignment"}', 'primary_market', '{"Primary Market", "Tier 1"}', 1, 40, '{"property_types": ["Single Family", "Townhouse", "Duplex"], "price_range": {"min": 60000, "max": 350000}, "condition": ["Any Condition"], "timeframe": "7-14 days", "markets": ["Charlotte", "Raleigh", "Greensboro"]}', 'MPP-011', false),
('Coastal Real Estate Group', 'Patricia', 'White', 'pat@coastalreg.com', '555-0202', 'active', 'https://app.hubspot.com/contacts/coastal-group', '{"Wholesale", "Cash Purchase"}', 'primary_market', '{"Primary Market", "Tier 1"}', 1, 35, '{"property_types": ["Single Family", "Condo"], "price_range": {"min": 50000, "max": 280000}, "condition": ["Move-in Ready", "Light Rehab"], "timeframe": "14-21 days", "markets": ["Wilmington", "Fayetteville", "Jacksonville"]}', 'CREG-012', false),
('Triangle Investment Solutions', 'Christopher', 'Garcia', 'chris@triangleis.com', '555-0203', 'active', 'https://app.hubspot.com/contacts/triangle-solutions', '{"Wholesale", "Subject To"}', 'primary_market', '{"Primary Market", "Tier 2"}', 2, 25, '{"property_types": ["Single Family", "Multi-Family"], "price_range": {"min": 70000, "max": 400000}, "condition": ["Light Rehab", "Heavy Rehab"], "timeframe": "21-30 days", "markets": ["Durham", "Chapel Hill", "Cary"]}', 'TIS-013', false),
('Piedmont Property Holdings', 'Nancy', 'Miller', 'nancy@piedmontph.com', '555-0204', 'active', 'https://app.hubspot.com/contacts/piedmont-holdings', '{"Wholesale", "Creative Financing"}', 'primary_market', '{"Primary Market", "Tier 1"}', 1, 30, '{"property_types": ["Single Family", "Townhouse"], "price_range": {"min": 55000, "max": 320000}, "condition": ["Any Condition"], "timeframe": "14-21 days", "markets": ["Winston-Salem", "High Point", "Kernersville"]}', 'PPH-014', false),
('Sandhills Real Estate Ventures', 'Daniel', 'Moore', 'dan@sandhillsrev.com', '555-0205', 'active', 'https://app.hubspot.com/contacts/sandhills-ventures', '{"Wholesale", "Fix and Flip"}', 'primary_market', '{"Primary Market", "Tier 1"}', 1, 28, '{"property_types": ["Single Family", "Duplex"], "price_range": {"min": 45000, "max": 270000}, "condition": ["Move-in Ready", "Light Rehab"], "timeframe": "7-14 days", "markets": ["Southern Pines", "Pinehurst", "Aberdeen"]}', 'SREV-015', false),
('Cape Fear Investment Group', 'Laura', 'Jackson', 'laura@capefearig.com', '555-0206', 'active', 'https://app.hubspot.com/contacts/cape-fear-group', '{"Wholesale", "Cash Purchase"}', 'primary_market', '{"Primary Market", "Tier 2"}', 2, 20, '{"property_types": ["Single Family", "Condo"], "price_range": {"min": 60000, "max": 330000}, "condition": ["Light Rehab", "Heavy Rehab"], "timeframe": "21-30 days", "markets": ["Wilmington", "Leland", "Carolina Beach"]}', 'CFIG-016', false),
('Appalachian Property Solutions', 'Mark', 'Thomas', 'mark@appalachianps.com', '555-0207', 'active', 'https://app.hubspot.com/contacts/appalachian-solutions', '{"Wholesale", "Subject To"}', 'primary_market', '{"Primary Market", "Tier 1"}', 1, 33, '{"property_types": ["Single Family", "Multi-Family"], "price_range": {"min": 40000, "max": 250000}, "condition": ["Any Condition"], "timeframe": "14-21 days", "markets": ["Asheville", "Hendersonville", "Black Mountain"]}', 'APS-017', false),
('Queen City Real Estate Partners', 'Elizabeth', 'Harris', 'liz@queencityrep.com', '555-0208', 'active', 'https://app.hubspot.com/contacts/queen-city-partners', '{"Wholesale", "Creative Financing"}', 'primary_market', '{"Primary Market", "Tier 1"}', 1, 38, '{"property_types": ["Single Family", "Townhouse"], "price_range": {"min": 65000, "max": 380000}, "condition": ["Move-in Ready", "Light Rehab"], "timeframe": "7-14 days", "markets": ["Charlotte", "Concord", "Gastonia"]}', 'QCREP-018', false),
('Research Triangle Investors', 'Brian', 'Clark', 'brian@rtinvestors.com', '555-0209', 'active', 'https://app.hubspot.com/contacts/rt-investors', '{"Wholesale", "Assignment"}', 'primary_market', '{"Primary Market", "Tier 2"}', 2, 22, '{"property_types": ["Single Family", "Duplex"], "price_range": {"min": 75000, "max": 420000}, "condition": ["Light Rehab", "Heavy Rehab"], "timeframe": "21-30 days", "markets": ["Raleigh", "Durham", "Wake Forest"]}', 'RTI-019', false),
('Outer Banks Property Group', 'Susan', 'Lewis', 'susan@obpg.com', '555-0210', 'active', 'https://app.hubspot.com/contacts/outer-banks-group', '{"Wholesale", "Cash Purchase"}', 'primary_market', '{"Primary Market", "Tier 1"}', 1, 15, '{"property_types": ["Single Family", "Condo"], "price_range": {"min": 80000, "max": 500000}, "condition": ["Any Condition"], "timeframe": "30-45 days", "markets": ["Nags Head", "Kill Devil Hills", "Duck"]}', 'OBPG-020', false),

-- Insert Secondary Market Investors  
('Blue Mountain Holdings', 'Anthony', 'Robinson', 'anthony@bluemh.com', '555-0301', 'active', 'https://app.hubspot.com/contacts/blue-mountain', '{"Assignment", "Novation"}', 'secondary_market', '{"Secondary Market", "Tier 2"}', 2, 12, '{"property_types": ["Single Family", "Mobile Home"], "price_range": {"min": 25000, "max": 150000}, "condition": ["Any Condition"], "timeframe": "45-60 days", "markets": ["Rural Counties", "Small Towns"]}', 'BMH-021', false),
('Valley View Investments', 'Karen', 'Walker', 'karen@valleyvi.com', '555-0302', 'active', 'https://app.hubspot.com/contacts/valley-view', '{"Assignment", "Creative Financing"}', 'secondary_market', '{"Secondary Market", "Tier 2"}', 2, 8, '{"property_types": ["Single Family", "Duplex"], "price_range": {"min": 30000, "max": 180000}, "condition": ["Light Rehab", "Heavy Rehab"], "timeframe": "60-90 days", "markets": ["Small Cities", "Suburban Areas"]}', 'VVI-022', false),
('Countryside Property Partners', 'Steven', 'Hall', 'steve@countrysidepp.com', '555-0303', 'active', 'https://app.hubspot.com/contacts/countryside-partners', '{"Assignment", "Subject To"}', 'secondary_market', '{"Secondary Market", "Tier 3"}', 3, 6, '{"property_types": ["Single Family", "Manufactured"], "price_range": {"min": 20000, "max": 120000}, "condition": ["Any Condition"], "timeframe": "90+ days", "markets": ["Rural Areas", "Farm Communities"]}', 'CPP-023', false),
('Highland Real Estate Group', 'Dorothy', 'Young', 'dorothy@highlandreg.com', '555-0304', 'active', 'https://app.hubspot.com/contacts/highland-group', '{"Assignment", "Wholesale"}', 'secondary_market', '{"Secondary Market", "Tier 2"}', 2, 10, '{"property_types": ["Single Family", "Townhouse"], "price_range": {"min": 35000, "max": 200000}, "condition": ["Move-in Ready", "Light Rehab"], "timeframe": "45-60 days", "markets": ["Secondary Cities", "Emerging Markets"]}', 'HREG-024', false),
('Riverbank Investment Solutions', 'Paul', 'King', 'paul@riverbankis.com', '555-0305', 'active', 'https://app.hubspot.com/contacts/riverbank-solutions', '{"Assignment", "Fix and Flip"}', 'secondary_market', '{"Secondary Market", "Tier 2"}', 2, 14, '{"property_types": ["Single Family", "Multi-Family"], "price_range": {"min": 40000, "max": 220000}, "condition": ["Heavy Rehab", "Tear Down"], "timeframe": "60-90 days", "markets": ["Smaller Markets", "Growth Areas"]}', 'RIS-025', false),
('Meadowbrook Property Holdings', 'Linda', 'Wright', 'linda@meadowbrookph.com', '555-0306', 'active', 'https://app.hubspot.com/contacts/meadowbrook-holdings', '{"Assignment", "Creative Financing"}', 'secondary_market', '{"Secondary Market", "Tier 3"}', 3, 7, '{"property_types": ["Single Family", "Condo"], "price_range": {"min": 28000, "max": 160000}, "condition": ["Any Condition"], "timeframe": "90+ days", "markets": ["Outlying Areas", "Developing Regions"]}', 'MPH-026', false),
('Crossroads Real Estate Ventures', 'Richard', 'Lopez', 'rick@crossroadsrev.com', '555-0307', 'active', 'https://app.hubspot.com/contacts/crossroads-ventures', '{"Assignment", "Novation"}', 'secondary_market', '{"Secondary Market", "Tier 2"}', 2, 11, '{"property_types": ["Single Family", "Duplex"], "price_range": {"min": 32000, "max": 190000}, "condition": ["Light Rehab", "Heavy Rehab"], "timeframe": "45-60 days", "markets": ["Mid-size Cities", "Transitional Areas"]}', 'CREV-027', false),
('Sunrise Property Group', 'Maria', 'Hill', 'maria@sunrisepg.com', '555-0308', 'active', 'https://app.hubspot.com/contacts/sunrise-group', '{"Assignment", "Subject To"}', 'secondary_market', '{"Secondary Market", "Tier 2"}', 2, 9, '{"property_types": ["Single Family", "Mobile Home"], "price_range": {"min": 25000, "max": 140000}, "condition": ["Any Condition"], "timeframe": "60-90 days", "markets": ["Rural Counties", "Agricultural Areas"]}', 'SPG-028', false),
('Lakeside Investment Partners', 'Charles', 'Green', 'chuck@lakesideip.com', '555-0309', 'active', 'https://app.hubspot.com/contacts/lakeside-partners', '{"Assignment", "Wholesale"}', 'secondary_market', '{"Secondary Market", "Tier 3"}', 3, 5, '{"property_types": ["Single Family", "Townhouse"], "price_range": {"min": 22000, "max": 130000}, "condition": ["Move-in Ready", "Light Rehab"], "timeframe": "90+ days", "markets": ["Remote Areas", "Vacation Communities"]}', 'LIP-029', false),
('Foothills Real Estate Solutions', 'Barbara', 'Adams', 'barb@foothillsres.com', '555-0310', 'active', 'https://app.hubspot.com/contacts/foothills-solutions', '{"Assignment", "Creative Financing"}', 'secondary_market', '{"Secondary Market", "Tier 2"}', 2, 13, '{"property_types": ["Single Family", "Multi-Family"], "price_range": {"min": 38000, "max": 210000}, "condition": ["Heavy Rehab", "Fixer Upper"], "timeframe": "45-60 days", "markets": ["Mountain Communities", "Recreational Areas"]}', 'FRES-030', false),

-- Additional High-Value Investors
('Premier Property Acquisitions', 'William', 'Baker', 'will@premierprop.com', '555-0401', 'active', 'https://app.hubspot.com/contacts/premier-acquisitions', '{"Cash Purchase", "Private Lending"}', 'statewide', '{"Direct Purchase", "High Volume"}', 1, 50, '{"property_types": ["Single Family", "Multi-Family", "Commercial"], "price_range": {"min": 100000, "max": 1000000}, "condition": ["Any Condition"], "timeframe": "7-14 days"}', 'PPA-031', false),
('Atlantic Coast Investors', 'Jessica', 'Nelson', 'jess@atlanticcoast.com', '555-0402', 'active', 'https://app.hubspot.com/contacts/atlantic-coast', '{"Cash Purchase", "Build to Rent"}', 'regional', '{"Direct Purchase", "Development"}', 1, 40, '{"property_types": ["Land", "Single Family", "Duplex"], "price_range": {"min": 75000, "max": 750000}, "condition": ["Any Condition"], "timeframe": "14-21 days"}', 'ACI-032', false),
('Triad Property Solutions', 'Thomas', 'Carter', 'tom@triadps.com', '555-0403', 'active', 'https://app.hubspot.com/contacts/triad-solutions', '{"Wholesale", "BRRRR"}', 'multi_market', '{"Primary Market", "BRRRR Specialist"}', 1, 35, '{"property_types": ["Single Family", "Small Multi-Family"], "price_range": {"min": 50000, "max": 300000}, "condition": ["Light Rehab", "Heavy Rehab"], "timeframe": "21-30 days"}', 'TPS-033', false),
('Coastal Carolina Holdings', 'Rachel', 'Mitchell', 'rachel@coastalcarolina.com', '555-0404', 'active', 'https://app.hubspot.com/contacts/coastal-carolina', '{"Cash Purchase", "Vacation Rentals"}', 'coastal', '{"Direct Purchase", "STR Focus"}', 2, 18, '{"property_types": ["Single Family", "Condo", "Townhouse"], "price_range": {"min": 150000, "max": 800000}, "condition": ["Move-in Ready", "Light Rehab"], "timeframe": "30-45 days"}', 'CCH-034', false),
('Granite State Property Group', 'Gregory', 'Perez', 'greg@granitespg.com', '555-0405', 'active', 'https://app.hubspot.com/contacts/granite-state', '{"Subject To", "Owner Finance"}', 'statewide', '{"Creative Financing", "Alternative Deals"}', 2, 20, '{"property_types": ["Single Family", "Duplex"], "price_range": {"min": 60000, "max": 400000}, "condition": ["Any Condition"], "timeframe": "45-60 days"}', 'GSPG-035', false),
('Blue Ridge Capital Partners', 'Stephanie', 'Roberts', 'steph@blueridgecp.com', '555-0406', 'active', 'https://app.hubspot.com/contacts/blue-ridge-capital', '{"Cash Purchase", "Commercial"}', 'regional', '{"Direct Purchase", "Commercial Focus"}', 1, 25, '{"property_types": ["Multi-Family", "Commercial", "Mixed Use"], "price_range": {"min": 200000, "max": 2000000}, "condition": ["Any Condition"], "timeframe": "30-45 days"}', 'BRCP-036', false),
('Sandhills Investment Corp', 'Jason', 'Turner', 'jason@sandhillsic.com', '555-0407', 'active', 'https://app.hubspot.com/contacts/sandhills-corp', '{"Wholesale", "Land Development"}', 'regional', '{"Development", "Land Specialist"}', 2, 15, '{"property_types": ["Land", "Tear Down", "Development"], "price_range": {"min": 25000, "max": 500000}, "condition": ["Any Condition"], "timeframe": "60-90 days"}', 'SIC-037', false),
('Mountain View Property Partners', 'Melissa', 'Phillips', 'mel@mountainviewpp.com', '555-0408', 'active', 'https://app.hubspot.com/contacts/mountain-view-partners', '{"Cash Purchase", "Luxury Rehab"}', 'mountain_region', '{"Direct Purchase", "Luxury Focus"}', 1, 12, '{"property_types": ["Single Family", "Luxury Homes"], "price_range": {"min": 300000, "max": 1500000}, "condition": ["Move-in Ready", "Light Rehab"], "timeframe": "21-30 days"}', 'MVPP-038', false),
('Triangle Tech Properties', 'Andrew', 'Campbell', 'andrew@triangletech.com', '555-0409', 'active', 'https://app.hubspot.com/contacts/triangle-tech', '{"BRRRR", "Tech-Enabled"}', 'tech_corridors', '{"Tech-Enabled", "Data Driven"}', 1, 45, '{"property_types": ["Single Family", "Townhouse", "Condo"], "price_range": {"min": 80000, "max": 600000}, "condition": ["Any Condition"], "timeframe": "14-21 days"}', 'TTP-039', false),
('Outer Banks Luxury Group', 'Nicole', 'Parker', 'nicole@obluxury.com', '555-0410', 'active', 'https://app.hubspot.com/contacts/ob-luxury', '{"Cash Purchase", "Luxury Vacation"}', 'coastal_luxury', '{"Luxury Market", "Vacation Homes"}', 1, 8, '{"property_types": ["Luxury Homes", "Waterfront", "Vacation Rentals"], "price_range": {"min": 500000, "max": 3000000}, "condition": ["Move-in Ready", "Light Rehab"], "timeframe": "45-60 days"}', 'OBLG-040', false);

-- Insert comprehensive coverage areas for all investors
INSERT INTO coverage_areas (investor_id, area_name, geojson_data, zip_codes, market_type) 
SELECT 
    i.id,
    CASE 
        WHEN i.coverage_type = 'statewide' THEN 'North Carolina Statewide'
        WHEN i.coverage_type = 'regional' THEN i.company_name || ' Regional Coverage'
        WHEN i.coverage_type = 'multi_market' THEN i.company_name || ' Multi-Market Coverage'
        WHEN i.coverage_type = 'primary_market' THEN i.company_name || ' Primary Markets'
        WHEN i.coverage_type = 'secondary_market' THEN i.company_name || ' Secondary Markets'
        WHEN i.coverage_type = 'coastal' THEN 'Coastal North Carolina'
        WHEN i.coverage_type = 'mountain_region' THEN 'Western North Carolina Mountains'
        WHEN i.coverage_type = 'tech_corridors' THEN 'Research Triangle & Tech Corridors'
        WHEN i.coverage_type = 'coastal_luxury' THEN 'Outer Banks Luxury Markets'
        ELSE i.company_name || ' Coverage Area'
    END as area_name,
    CASE 
        WHEN i.coverage_type = 'statewide' THEN 
            '{"type":"Polygon","coordinates":[[[-84.5,-33.7],[-84.5,-36.7],[-75.3,-36.7],[-75.3,-33.7],[-84.5,-33.7]]]}'::jsonb
        WHEN i.coverage_type = 'coastal' OR i.coverage_type = 'coastal_luxury' THEN
            '{"type":"Polygon","coordinates":[[[-78.0,33.8],[-78.0,36.5],[-75.4,36.5],[-75.4,33.8],[-78.0,33.8]]]}'::jsonb
        WHEN i.coverage_type = 'mountain_region' THEN
            '{"type":"Polygon","coordinates":[[[-84.5,35.0],[-84.5,36.7],[-81.0,36.7],[-81.0,35.0],[-84.5,35.0]]]}'::jsonb
        WHEN i.coverage_type = 'tech_corridors' THEN
            '{"type":"Polygon","coordinates":[[[-79.5,35.5],[-79.5,36.2],[-78.2,36.2],[-78.2,35.5],[-79.5,35.5]]]}'::jsonb
        ELSE 
            '{"type":"Polygon","coordinates":[[[-80.0,35.0],[-80.0,36.0],[-79.0,36.0],[-79.0,35.0],[-80.0,35.0]]]}'::jsonb
    END as geojson_data,
    CASE 
        WHEN i.coverage_type = 'statewide' THEN 
            ARRAY['27601','27603','27605','27607','27609','27511','27513','27515','27517','27519','28202','28204','28206','28208','28210','28212','28214','28216','28217','28269','28270','28273','28277','28278','28280','28282','28226','28227','28105','28134','28173','28174','28203','28205','28207','28209','28211','28213','28215','28262','28301','28303','28305','28306','28307','28310','28311','28314','28390','28401','28403','28405','28409','28411','28412','28451','28461','27265','27282','27284','27295','27407','27408','27409','27410','27455','27560','27562','27587','27597']
        WHEN i.coverage_type = 'coastal' OR i.coverage_type = 'coastal_luxury' THEN
            ARRAY['28401','28403','28405','28409','28411','28412','28451','28461','28462','28464','28465','28466','28467','28468','28469','28470','28472','28480','28584','28585','28586','28587','28590','27949','27950','27953','27954','27958','27959','27960','27966','27968','27972','27973','27976','27978','27979','27980','27981','27982']
        WHEN i.coverage_type = 'mountain_region' THEN
            ARRAY['28701','28702','28704','28705','28707','28708','28709','28710','28711','28712','28713','28714','28715','28716','28717','28718','28719','28720','28721','28722','28723','28724','28725','28726','28727','28728','28729','28730','28731','28732','28733','28734','28735','28736','28737','28738','28739','28740','28741','28742','28743','28744','28745','28746','28747','28748','28749','28750','28751','28752','28753','28754','28755','28756','28757','28758','28759','28760','28761','28762','28763','28764','28765','28766','28767','28768','28770','28771','28772','28773','28774','28775','28777','28778','28779','28781','28782','28783','28785','28786','28787','28788','28789','28790','28791','28792','28793','28801','28803','28804','28805','28806','28810','28813','28814','28815','28816','28901','28902','28903','28904','28905','28906']
        WHEN i.coverage_type = 'tech_corridors' THEN
            ARRAY['27601','27603','27605','27607','27609','27511','27513','27515','27517','27519','27560','27562','27587','27597','27701','27703','27705','27707','27709','27511','27513','27515','27517','27519','27540','27541','27542','27560','27562','27587','27597','27510','27511','27513','27514','27515','27516','27517','27518','27519','27520','27521','27522','27523','27524','27525','27526','27527','27529','27530','27539','27540','27541','27542','27544','27545','27546','27549','27560','27562','27563','27565','27569','27571','27572','27576','27577','27581','27582','27583','27587','27591','27592','27596','27597','27599']
        ELSE 
            ARRAY['27265','27282','27284','27295','27407','27408','27409','27410','27455','28202','28204','28206','28208','28210','28212','28214','28216','28217','28269','28270','28273','28277','28278','28280','28282','28226','28227','28105','28134','28173','28174','28203','28205','28207','28209','28211','28213','28215','28262','28301','28303','28305','28306','28307','28310','28311','28314','28390']
    END as zip_codes,
    CASE 
        WHEN i.investor_tags @> '{"Primary Market"}' THEN 'primary'
        WHEN i.investor_tags @> '{"Secondary Market"}' THEN 'secondary'
        ELSE 'primary'
    END as market_type
FROM investors i;